$.ajax({
  setup,
  success: function (data) {
    getRisk(data);
  },
});

function getRisk(data) {
  $.ajax({
    url:
      'https://europe.grc1.com/iGRC/api/Control/GetById_Summary/' +
      localStorage.getItem('risk id'),
    method: 'GET',
    headers: {
      Authorization: 'BEARER ' + data.access_token,
    },
    success: function (data2) {
      $('.api-loader').hide();
      console.log(data2);
      const c = data2;

      //Shared Values
      getSharedValues(c);

      //Overview Page
      getOverviewValues(c)

    },
    error: function (e) {
      console.log('error');
    },
  });
}

//Get Shared Values
function getSharedValues(c) {
  $('.control-name').html(c.ControlName);
  $('.control-office').html(c.Office);
  $('.created-by-name').html(c.CreatedBy);
  $('.audit-date').html(
    c.LastAuditDate !== null ? c.LastAuditDate.split('T')[0] : 'none'
  );
  $('.audit-last-review-date').html(
    c.LastReviewDate !== null ? c.LastReviewDate.split('T')[0] : 'none'
  );
  $('.audit-next-review-date').html(
    c.NextReviewDate !== null ? c.NextReviewDate.split('T')[0] : 'none'
  );
  $('.control-owner-name').html(c.Owner);
}

// Get Overview Values
function getOverviewValues(c){

  $('#control-linked-risks').html(c.LinkedRisks ? c.LinkedRisks : 'none');
  $('#control-description').html(c.ControlDescription);
  $('#control-category').html(c.ControlCategory);
  $('#control-subcategory').html(c.ControlSubCategory);
  $('#control-business-unit').html(c.BusinessUnit);
  $('#control-regulator').html(c.Regulator ? c.Regulator : '-');

  //Table values
  $('#control-effectiveness').html(c.ControlEffectiveness);
  $('#control-importance').html(c.ControlImportance);
  $('#control-last-audit-reference').html(
    c.LastAuditRef ? c.LastAuditRef : '-'
  );
  // $('#control-cost-of-control').html()
  // $('#control-savings').html()
  // $("control-implementation-status").html()
}
