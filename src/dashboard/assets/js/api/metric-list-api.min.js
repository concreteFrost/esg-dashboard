$.ajax({
  setup,
  success: function (data) {
    getMetric(data);
  },
});

//Get All
function getMetric(data) {
  $.ajax({
    url: 'https://europe.grc1.com/iGRC/api/Metric/Get',
    method: 'GET',
    data: {
      tenantName: 'ESG-ONE',
    },
    headers: {
      Authorization: 'Bearer ' + data.access_token,
    },

    success: function (data2) {
      //Remove Pre-Loader
      $('#metrics-datatable').parent().next().remove();
      const metricArr = data2;
      console.log(metricArr);
      metricArr.forEach((metric) => {
        const el = ` <tr>
                 <td>${metric.MetricNumber}</td>
                <td><a href="/dashboard/company/individual-metric.html#overview" onclick="redirectToMetric(this)" data-id=${
                  metric.MetricId
                }> ${metric.Name} </a></td>
         
                <td>-</td>
                <td>${metric.Category}</td>
                <td>${
                  metric.Subcategory === null ? '-' : metric.Subcategory
                }</td>
                <td>
                <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#editMetricModal" onclick="redirectToMetric(this)" data-id=${
                  metric.MetricId
                }>edit</button>
                <button class="btn btn-danger btn-sm" onclick="performDeletion(this)" data-id="${
                  metric.MetricId
                }">delete</button>
                </td>
              </tr>
                `;
        $('#metric-table-body').append(el);
      });

      var dt = new DT('#metrics-datatable');
    },
  });
}

//Delete Metric By Id
function performDeletion(e) {
  $(e).closest('tr').remove();
}

//Create Table
function redirectToMetric(e) {
  localStorage.setItem('metric id', $(e).data('id'));
  console.log(localStorage.getItem('metric id'));
}
