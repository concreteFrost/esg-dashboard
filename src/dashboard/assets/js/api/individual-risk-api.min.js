$.ajax({
  setup,
  success: function (data) {
    getRisk(data);
  },
});

function getRisk(data) {
  console.log(data);
  $.ajax({
    url:
      'https://europe.grc1.com/iGRC/api/Risk/GetById_Summary?riskId=' +
      localStorage.getItem('risk id'),
    method: 'GET',
    headers: {
      Authorization: 'BEARER ' + data.access_token,
    },
    success: function (data2) {
      var r = data2;
      console.log(data2);

      //Shared values
      $('.api-loader').hide();
      $('.risk-name').html(r.RiskName);
      $('.risk-office').html(r.Office);
      $('.risk-consequence').html(r.Consequence);

      //Overview Page
      $('#risk-business-unit').html(r.BusinessUnit);
      $('#risk-category').html(r.RiskCategory);
      $('#risk-subcategory').html(r.RiskSubcategory);
      $('#risk-description').html(r.RiskDescription);

      //Table Values
      $('#individual-risk-score').html(r.RegisterCurrentScore);
      $('#individual-risk-target').html(r.TargetScore);      
      $('#individual-risk-exposure').html(r.ResidualFinancialExposure ? r.ResidualFinancialExposure : '-');
      $('#individual-risk-appetite').html(r.RiskAppetite ? r.RiskAppetite : '-');
      $('#individual-risk-proximity').html(r.Proximity);
      $('#individual-risk-business-trend').html(r.BusinessTrend ? r.BusinessTrend : '-');
      // $('#individual-risk-priority').html(r.RegisterCurrentScore);

      $('#proximity').html(r.Proximity);
      $('#risk-owner-name').html(r.OwnerName);
      $('#score-update').html(r.LastResidualRiskScoreUpdate.split('T')[0]);
      $('#score-last-review-date').html(r.LastReviewDate.split('T')[0]);
      $('#score-next-review-date').html(r.NewReviewDate);

      //Scoring Page
      //Scoring Calc
      $('#scoring-pre-metigation-calc').html(r.RegisterPreImpactScore + " X " + r.RegisterPreLikelihoodScore + "=" + r.RegisterPreScore)
      $('#scoring-current-score-calc').html(r.RegisterCurrentImpactScore + " X " + r.RegisterCurrentLikelihoodScore + "=" + r.RegisterCurrentScore)
      $('#scoring-target-score-calc').html(r.RegisterTargetImpactScore + " X " + r.RegisterTargetLikelihoodScore + "=" + r.RegisterTargetScore)

      //Impacts Page
      $('#impact-type').html(r.ImpactType ? r.ImpactType : 'none')
    },
    error: function (e) {
      console.log('error');
    },
  });
}

$('#print').click(() => {
  $('#print').printThis();
});
