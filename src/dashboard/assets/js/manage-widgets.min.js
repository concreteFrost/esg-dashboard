//On TRUE allows to move cards
var draggable = false;

//Sortable lists enabled
$('#manage-cards-btn').click(() => {
  $('#sortable-1').sortable({
    connectWith: '#sortable-2',
  });

  $('#sortable-2').sortable({
    connectWith: '#sortable-1',
  });
});

//Add or Remove cards on `save changes` click
$('#save-cards-btn').click(() => {
  $('#sortable-1 li').each((id, el) => {
    let match = '#' + $(el).html().toLowerCase().replace(' ', '-') + `-card`;
    $(match).show();
  });
  $('#sortable-2 li').each((id, el) => {
    let match = '#' + $(el).html().toLowerCase().replace(' ', '-') + `-card`;
    $(match).hide();
  });

});

//Change colors on dragging list items
$('#sortable-2').bind('DOMSubtreeModified', function () {
  $('#sortable-2 li').each((id, el) => {
    $(el).removeClass('btn-success');
    $(el).addClass('btn-secondary');
  });
});

$('#sortable-1').bind('DOMSubtreeModified', function () {
  $('#sortable-1 li').each((id, el) => {
    $(el).addClass('btn-success');
    $(el).removeClass('btn-secondary');
  });
});

//Enable card swapping
$('#swap-cards-btn').click(() => {


  draggable = !draggable;
  if (draggable) {
    $('#kpis-sort-cards-1').sortable();
    $('#kpis-sort-cards-2').sortable();
    $("#material-metrics-sort-cards-1").sortable();
    $("#material-metrics-sort-cards-2").sortable();
    $('#widgets-grid').sortable();
   
  } else {
    $('#kpis-sort-cards-1').sortable('destroy');
    $('#kpis-sort-cards-2').sortable('destroy');
    $("#material-metrics-sort-cards-1").sortable('destroy');
    $("#material-metrics-sort-cards-2").sortable('destroy');
    $('#widgets-grid').sortable('destroy');
  }
});

//get carousel state on load
$(document).ready(()=>{
  var carousel_state = JSON.parse(localStorage.getItem('carousel-on'));
  if(carousel_state){
    $('#carousel-animation').attr('checked', true);
    $('.carousel').carousel('cycle');
  }
  else{
    $('#carousel-animation').attr('checked', false);
    $('.carousel').carousel('pause');
  }
})

//set carousel state on change 
$('#carousel-animation').on('change',()=>{
  if ($('#carousel-animation').is(':checked')) {
    localStorage.setItem('carousel-on',true)
    $('.carousel').carousel('cycle');
  } 
  else if (!$('#carousel-animation').is(':checked')) {
    localStorage.setItem('carousel-on',false)
    $('.carousel').carousel('pause');
   
  }
})

