
if(location.href.includes("actions")){
  $('#team-tasks').removeClass('col-xl-6').addClass('col');
}

//Add New Task
$('#add-new-task-btn').click(() => {
  const taskName = $('#taskName').val();
  const taskType = $('#taskType').find(':selected').val();
  let taskTeam = [];
  $.each($("input[name='team-check']:checked"), function () {
    taskTeam.push({
      val: $(this).data('value'),
      tooltip: $(this).data('title'),
    });
  });
  var taskStatus = $('#taskStatus').find(':selected').val();
  var taskColor =$('#taskStatus').find(':selected').data('status-color')
  console.log(taskColor)
  if (taskName.length > 0 && taskTeam.length > 0) {
    $('#tasks-table-body').append(
      `<tr>
        <th scope="row" class="name">${taskName}</th>
        <td class="type">${taskType}</td>
        <td > <div class="avatar-group">
        ${taskTeam.map((e) => {
          return `<a 
          class="avatar avatar-sm rounded-circle"
          data-toggle="tooltip"
          title="${e.tooltip}"
        >
          <img
            alt="Image placeholder"
            src="${e.val}"
          />
        </a>`
        })}
        </div></td>
        <td><span class="badge badge-dot mr-4">
        <i class="${taskColor}"></i>
        <span class="status">${taskStatus}</span>
      </span></td>
        <td>
        <div class="d-flex align-items-center">
          <span class="completion mr-2">0%</span>
          <div>
            <div class="progress">
              <div
                class="progress-bar bg-info"
                role="progressbar"
                aria-valuenow="0"
                aria-valuemin="0"
                aria-valuemax="100"
                style="width: 0%"
              ></div>
            </div>
          </div>
        </div>
      </td>
      <td>
      <button class="btn btn-danger btn-sm" onclick="DeleteTask(this)">Delete</button>
      </td>
        </tr>`
    );
    $('#tasksModal').modal('hide');
    $('body').tooltip({
        selector: '[data-toggle="tooltip"]'
    });

    $('#taskName').val('')
  }
});

//Delete Task
function DeleteTask(task){
  $(task).parent().parent().remove()
}

//Track changes in table
$('#tasks-table-body').on("DOMSubtreeModified",()=>{
 showHideEmptyTasksMessage()
})

//Track changes in table on load
$(document).ready(()=>{
  showHideEmptyTasksMessage()
})

function showHideEmptyTasksMessage(){
  if($('#tasks-table-body tr').length<=0){
    $('#empty-tasks-message').removeClass('d-none')
  }
  else
  $('#empty-tasks-message').addClass('d-none')
}
