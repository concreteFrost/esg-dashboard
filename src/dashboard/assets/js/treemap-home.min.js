$('#expand-treemap-btn').click(() => {
  $('#_treemap').toggleClass('col-12');
  $('#_treemap').toggleClass('col-xl-6');
});

$.getJSON('/dashboard/assets/data/treemap.json', (data) => {
  chart = anychart.treeMap(data, 'as-tree');
  // set the container id
  chart.container('domainDrillDown');
  // set the maximum depth of levels shown
  chart.maxDepth(2);
  // set the depth of hints
  chart.hintDepth(1);
  // set the opacity of hints
  chart.hintOpacity(0.5);
  var customColorScale = anychart.scales.linearColor();
  customColorScale.colors(['#B9EBEB', '#028FE0']);
  chart.headers().fontWeight('bold');

  chart.headers().background('#1ba2c1');
  chart.headers().fontColor('white');

  chart.tooltip().format(function () {
    return (
      this.oc.kg.ka.value +
      '% of 100 required policies and processes are currently in place'
    );
  });

  chart.labels().format(function () {
    
    return this.name + ' ' + this.oc.kg.ka.value + '%';
  });

  // add a color range
  chart.listen('drillchange', function (e) {
    $('#gaps-title').html(e.current.node.ka.name);
    $('#gaps-body').empty();
    e.current.node.b.forEach((n) => {
      var tableData = `<tr><td>${n.ka.name}</td>
    <td>${n.ka.value}</td>
    <td>${n.ka.size}</td>
    </tr>`;
      $('#gaps-body').append(tableData);
    });
  });
  chart.draw();
});
