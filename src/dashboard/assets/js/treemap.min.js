/*
 =========================================================
 esg:one Dashboard Application
 =========================================================
 @license Copyright 2021 Beathamm Ltd (https://esg-one.co)
 @author  22 Digital Ltd (https://22digital.ltd)
 @author  Justin Hartman <code@22digital.ltd>
*/
var margin={top:10,bottom:10,left:10,right:10},width=$("#card").width()-margin.left-margin.right,height=450,legend=["Environment","Social","Governance"],color=d3.scaleOrdinal().range(["#3C7BC5","#1BA2C1","#5DBFC2"]).domain(legend),tree=d3.treemap().size([width,height]).padding(1).round(!0);
d3.csv("/dashboard/assets/data/treemap.csv",function(b,a){a.forEach(function(a){a.value=+a.value1;a.value2=+a.value2});var c=stratifyData(a);tree(c);c=d3.select("#viz").selectAll(".node").data(c.leaves(),function(a){return a.data.name}).enter().append("div").attr("class","node");c.append("div").attr("class","node-label");c.append("div").attr("class","node-value");c.call(position)});
function stratifyData(b){console.log(b);return d3.stratify().id(function(a){return a.name}).parentId(function(a){return a.parent})(b).sum(function(a){return a.value}).sort(function(a,b){return b.height-a.height||b.value-a.value})}
function position(b){b.attr("title",function(a){return a.id+"\n"+a.value+" T / $ rev"}).style("left",function(a){return a.x0+"px"}).style("top",function(a){return a.y0+"px"}).style("width",function(a){return a.x1-a.x0+"px"}).style("height",function(a){return a.y1-a.y0+"px"}).style("background",function(a,b){return a.children?null:color(a.parent.data.name)});b.select(".node-label").text(function(a){return a.data.name});b.select(".node-value").text(function(a){return a.data.value})}
var svg=d3.select("#viz").append("svg").attr("width",width).attr("height",height+70).append("g").attr("class","legend").attr("transform","translate(5, "+(height+40)+")");svg.append("text").style("font-weight","bold").attr("x",0).attr("y",-15).text("Legend");var legendItem=svg.selectAll(".legend-item").data(legend).enter().append("g").attr("class","legend-item").attr("transform",function(b,a){return 2==a?"translate("+120*a+",0)":"translate("+150*a+",0)"});
legendItem.append("rect").attr("width",20).attr("height",20).style("fill",function(b){return color(b)});legendItem.append("text").attr("x",25).attr("y",15).text(function(b){return b});
