$(document).ready(() => {
  $('#checklist-container').click((e) => {
    e.stopPropagation();
  });
  const check = [
    '#cards-check',
    '#performance-check',
    '#readiness-check',
    '#risks-check',
    '#locations-check',
    '#todo-check',
    '#team-tasks-check',
  ];

  const targets = [
    '#cards-grid',
    '#_treemap',
    '#readiness',
    '#risks',
    '#locations',
    '#todo',
    '#team-tasks',
  ];

  for (let i = 0; i < check.length; i++) {
    $(check[i]).attr('checked', JSON.parse(localStorage.getItem(check[i])));
    getCheckbox(check[i], targets[i]);
    setCheckbox(check[i], targets[i]);
  }

  $('#show-all').click(() => {
    check.forEach((e) => {
      $(`${e}:checkbox`).attr('checked', true);
      localStorage.setItem(e, true);
    });
    targets.forEach((e) => {
      $(e).show();
      
    });
  });
  
  $('#hide-all').click(() => {
    check.forEach((e) => {
      $(`${e}:checkbox`).attr('checked', false);
      localStorage.setItem(e, false);
    });
    targets.forEach((e) => {
      $(e).hide();
    });
  });
  
});

function getCheckbox(check, target) {
  $(`${check}:checkbox`).each(function () {
    var storageExist = JSON.parse(localStorage.getItem(check));
    if (storageExist === null) {
      $(check).attr('checked', 'true');
      $(target).show();
    }
    if ($(this).is(':checked')) {
      $(target).show();
      localStorage.setItem(check, true);
    } else {
      $(target).hide();
      localStorage.setItem(check, false);
    }
  });
}

function setCheckbox(check, target) {
  $(`${check}:checkbox`).change(function () {
    if ($(this).is(':checked')) {
      $(target).show();
      localStorage.setItem(check, true);
    } else {
      $(target).hide();
      localStorage.setItem(check, false);
    }
  });
}


